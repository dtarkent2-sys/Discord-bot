DISCORD_TOKEN=your_discord_bot_token_here
DISCORD_CLIENT_ID=your_client_id_here

# ── Persistent Storage ──
# Set DATA_DIR to a Railway volume mount path so memory, reactions, trade journal,
# and all learned data survive across deployments. Without this, the filesystem is
# ephemeral and everything resets on every deploy.
# Railway: create a volume (e.g. /data), then set DATA_DIR=/data
# DATA_DIR=/data

# Ollama Cloud (default)
OLLAMA_HOST=https://ollama.com
OLLAMA_API_KEY=your_ollama_api_key_here
OLLAMA_MODEL=qwen2.5:14b

# Or for local Ollama, uncomment these instead:
# OLLAMA_HOST=http://localhost:11434
# OLLAMA_API_KEY=
# OLLAMA_MODEL=qwen2.5:14b

# Or use the custom Sprocket Modelfile (run: ollama create sprocket -f Modelfile)
# OLLAMA_MODEL=sprocket

# Approximate training data cutoff for your Ollama model
# Used in system prompts to enforce RAG freshness rules
# Kimi K2.5 / Qwen 2.5 = December 2024, Llama 3.3 = December 2023
MODEL_CUTOFF=December 2024

# Log level: debug, info, warn, error (default: info)
# LOG_LEVEL=info

# GitHub self-edit (for !update, !suggest, !autoedit commands)
GITHUB_TOKEN=your_github_personal_access_token
GITHUB_OWNER=dtarkent2-sys
GITHUB_REPO=Discord-bot
GITHUB_BRANCH=main

# AI coder (for !suggest and !autoedit commands)
ANTHROPIC_API_KEY=your_anthropic_api_key_here

# Kimi K2.5 Agent Mode (optional — enables built-in web search via Moonshot AI)
# Get your API key at https://platform.moonshot.ai/console/api-keys
# When set, the bot uses Kimi's agent mode with server-side web search for real-time answers
KIMI_API_KEY=your_moonshot_api_key_here
KIMI_BASE_URL=https://api.moonshot.ai/v1
KIMI_MODEL=kimi-k2.5-preview

# Market data via Financial Modeling Prep (FMP)
# Get your free API key at https://financialmodelingprep.com/developer
FMP_API_KEY=your_fmp_api_key_here

# Alpha Vantage API (market data, server-side technicals, news sentiment, fundamentals)
# Get your free API key at https://www.alphavantage.co/support/#api-key
# Powers: price fallback, server-side RSI/MACD/BBANDS/ATR, news sentiment, company overview
# Free tier: 25 calls/day. Premium plans at https://www.alphavantage.co/premium/
# MCP server: https://mcp.alphavantage.co/
ALPHA_API_KEY=your_alpha_vantage_api_key_here

# Alpaca Markets (real-time data + options + trade execution)
# Alpaca Markets (free real-time data + options for GEX + WebSocket stream)
# Sign up at https://alpaca.markets — paper trading account works
# Powers: /gex, /technicals, and SHARK autonomous trading
ALPACA_API_KEY=your_alpaca_api_key_here
ALPACA_API_SECRET=your_alpaca_api_secret_here
# Set to 'false' for LIVE trading (default: paper)
ALPACA_PAPER=true
# WebSocket feed: 'iex' (free) or 'sip' (Algo Trader Plus subscription)
ALPACA_FEED=iex

# Web search via SearXNG (free, open-source — no API key needed)
# Use a public instance or self-host: https://docs.searxng.org
SEARXNG_URL=https://search.ononoki.org

# Bot owner (your Discord user ID — required for !update, !suggest, !autoedit)
BOT_OWNER_ID=your_discord_user_id
BOT_PREFIX=!

PORT=3000
TRADING_CHANNEL=trading-floor
GENERAL_CHANNEL=general

# SHARK autonomous trading agent
# Set to 'true' to auto-enable the agent on every deploy/restart
# (Railway wipes filesystem on deploys, so file-based persistence doesn't survive)
SHARK_AUTO_ENABLE=true

# Databento OPRA (institutional-grade real-time options data — PRIMARY data source)
# Sign up at https://databento.com — new accounts get $125 free credits
# Dataset: OPRA.PILLAR (consolidated US options feed, all 17 exchanges)
# Powers: tick-level NBBO quotes, trade prints, open interest, instrument defs
# Note: Databento does NOT provide greeks — pair with Tradier for delta/gamma/theta/vega
DATABENTO_API_KEY=your_databento_api_key_here
# Set to 'true' to enable real-time OPRA streaming via TCP (requires $199/mo OPRA subscription)
# Activate live data at: https://databento.com/portal — fill out subscriber questionnaire
# Without this, Billy uses the historical HTTP API (~30min delayed, pay-per-query)
DATABENTO_LIVE=false

# Tradier API (options chain with ORATS real greeks — used alongside Databento for greeks)
# Sign up at https://tradier.com — sandbox is free, no funded account needed
# Powers: real greeks (ORATS), open interest, full chain in one API call
# Set TRADIER_SANDBOX=false when using a production token
TRADIER_API_KEY=your_tradier_api_key_here
TRADIER_SANDBOX=true

# Public.com API (real-time options chain with greeks)
# Sign up at https://public.com — generate API key in Account Settings > Security > API
# Powers: 0DTE options chain data with real greeks (fallback when Tradier unavailable)
PUBLIC_API_KEY=your_public_api_key_here
PUBLIC_ACCOUNT_ID=your_public_account_id_here

# AInvest API (news, candles, fundamentals, analyst ratings, earnings)
# Get your API key at https://docs.ainvest.com
# Enriches: price fallback, news search, fundamentals for trading agents + alerts
AINVEST_API_KEY=your_ainvest_api_key_here

# SPY 0DTE Alert Integration (TradingView → HTTP Webhook → Discord)
# 1. Set SPY_CHANNEL_ID to the Discord channel where alerts should be posted
# 2. In TradingView, set webhook URL to: https://YOUR-APP.up.railway.app/webhook/tradingview
#    (Optional: add ?secret=YOUR_SECRET for auth)
# 3. Set your TradingView alert message to JSON, e.g.:
#    {"action":"{{strategy.order.action}}","ticker":"{{ticker}}","price":{{close}}}
#    The bot accepts ANY JSON format — it auto-detects common TradingView fields.
SPY_CHANNEL_ID=YOUR_SPY_CHANNEL_ID
# Optional: authenticate webhook requests (add ?secret=... to TradingView URL)
WEBHOOK_SECRET=
# Lighter/faster Ollama model for alert analysis (default: qwen3:4b)
ALERT_OLLAMA_MODEL=qwen3:4b
# Cache TTL for SPY price/news in milliseconds (default: 60000 = 60s)
ALERT_CACHE_TTL=60000
# Follow-up delay in milliseconds (default: 300000 = 5 minutes)
ALERT_FOLLOWUP_MS=300000

# GEX Engine — Multi-Expiry Gamma Exposure Analysis
# Comma-separated list of expirations to include: 0dte, weekly, monthly (or YYYY-MM-DD dates)
GEX_INCLUDE_EXPIRIES=0dte,weekly,monthly
# Number of consecutive candle closes required for break-and-hold alerts
GEX_HOLD_CANDLES=3
# Candle interval for break-and-hold: 1Min, 5Min, 15Min, 1Hour, 1Day
GEX_CANDLE_INTERVAL=5Min
# Minimum regime confidence (0-1) before emitting alerts (default: 0.4)
GEX_MIN_REGIME_CONFIDENCE=0.4
# Minimum absolute GEX ($) to consider an expiry "dominant" (default: 1000000 = $1M)
GEX_MIN_ABS_GEX=1000000

# Singleton Lock — ensures only one bot instance connects to Discord (Railway deploys)
# Set REDIS_URL to enable distributed leader lock. Without it, lock is disabled (single-instance mode).
# Supports both redis:// (plain TCP) and rediss:// (TLS) URLs.
# On Railway: add a reference variable  REDIS_URL=${{Redis.REDIS_URL}}  in your bot service.
# REDIS_URL=redis://default:password@host:6379
# LEADER_LOCK_TTL_SECONDS=60
# LEADER_LOCK_RENEW_SECONDS=30

# WebSearch Feature Flag — disable in production to avoid SearXNG 429 spam
# Default: true in dev, false when RAILWAY_ENVIRONMENT is set
# WEBSEARCH_ENABLED=false

# Dashboard Public URL — used for clickable links in Discord messages
# Auto-detected on Railway (RAILWAY_PUBLIC_DOMAIN). Set manually for other hosts.
# Example: https://my-bot.up.railway.app
# DASHBOARD_URL=https://your-bot-url.up.railway.app

# Provider Resilience — override rate limits and cache TTLs (JSON format, optional)
# RATE_LIMITS={"ainvest":{"maxTokens":30,"refillPerSecond":2},"fmp":{"maxTokens":20,"refillPerSecond":1}}
# CACHE_TTLS={"news":1200000,"candles_1m":20000,"candles_5m":90000}
